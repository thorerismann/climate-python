knitr::opts_chunk$set(echo = TRUE)
library('reticulate')
use_condaenv('master-class',required = T)
reticulate::repl_python()
summary(cars)
plot(pressure)
knitr::opts_chunk$set(echo = FALSE)
library(extRemes)
library(ggplot2)
library(foreign)
library(dplyr)
library(grid)
setwd("d:/euclasses/enveconmetrics/extreme_class")
knitr::opts_chunk$set(echo = FALSE)
library(extRemes)
library(ggplot2)
library(foreign)
library(dplyr)
library(grid)
dat1 <- read.dta("centralpark.dta")
head(dat1)
summary(dat1$tmax)
hist(dat1$tmax,
main="Max Daily Winter Temperature in Central Park",
xlab="Degrees")
plot(dat1$tmax, type = "l", col = "darkblue",
xlab = "Year", ylab = "Max Temp")
fit1 <- fevd(tmax, dat1)
fit1
ci(fit1, type="parameter")
plot(fit1, "qq")
plot(fit1, "qq2")
plot(fit1, "rl")
fit2 <- fevd(tmax, dat1, type="Gumbel")
lr.test(fit1, fit2)
trend=dat1$year-min(dat1$year)+1
fit3 <- fevd(tmax, dat1, shape.fun = ~ trend + I(trend^2))
lr.test(fit1, fit3)
dat2 <- read.dta("caribbean.dta")
head(dat2)
sum(dat2$damage)
plot(dat2$damage, type = "h", col = "darkblue",
xlab = "Year", ylab = "Damage")
mrlplot(dat2$damage)
trange<-range(dat2$year)
trange
nyears<-trange[2]-trange[1]+1
dimd<-dim(dat2)
dimd
nevents<-dimd[1]
nevents/nyears
fitD<-fevd(damage, dat2, threshold=1000,
type="GP", time.units="2.62/year")
ci(fitD, type="parameter")
plot(fitD, "qq")
plot(fitD, "rl")
return.level(fitD, c(10, 20, 100))
ci(fitD, type="return.level", return.period=200)
probst<-pextRemes(fitD, c(2000, 3000, 10000), lower.tail=FALSE)
probst
fitD3<-fevd(damage, dat2, threshold=1000,
scale.fun = ~ soiyearly + noaannual,
shape.fun = ~ soiyearly + noaannual,
type="GP", time.units="2.62/year")
ci(fitD3, type="parameter")
lr.test(fitD, fitD3)
look1 <- summary(fitD, silent=TRUE)
look1 <- c(look1$AIC, look1$BIC)
look2 <- summary(fitD3, silent=TRUE)
look2 <- c(look2$AIC, look2$BIC)
# Lower AIC/BIC is better.
names(look1) <- names(look2) <- c("AIC", "BIC")
look1
look2
fitD3$parnames
mlow<-matrix(1,3,6)
mlow[,2]=4
mlow[,3]=4
mlow[,5]=4
mlow[,6]=4
mlow
mhigh<-matrix(1,3,6)
mhigh[,2]=7
mhigh[,3]=7
mhigh[,5]=7
mhigh[,6]=7
mhigh
vlow=make.qcov(fitD3, vals=mlow)
vhigh=make.qcov(fitD3, vals=mhigh)
probex1<-pextRemes(fitD3, q=c(2000, 5000, 10000),
qcov = vhigh, qcov.base = vlow,
lower.tail=FALSE)
probex1
FAR<- 1- probst[1]/probex1[1]
FAR
fitD4<-fevd(damage, dat2, threshold=1000, type="PP")
fitD4
plot(fitD4, "Zplot")
dat3 <- read.dta("cptmax.dta")
